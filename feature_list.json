{"features":[{"id":"F001","category":"core","description":"Track token usage (input, output, total) for each OpenCode session in orchestrator","priority":"critical","steps":["Add token usage extraction from OpenCode session events","Store token metrics in SessionMetrics structure","Verify token counts are captured during session execution","Confirm tokenUsage field is populated in metrics array"],"passes":true},{"id":"F002","category":"core","description":"Display per-session token usage in session summary output","priority":"critical","steps":["Add token usage display to session summary in orchestrator","Show input, output, and total tokens for completed session","Format token counts with thousands separators","Verify token display appears after each coding session"],"passes":true},{"id":"F003","category":"core","description":"Calculate and display total token usage across all sessions","priority":"critical","steps":["Sum token usage across all sessions in orchestration summary","Display total input, output, and total tokens","Calculate and show average tokens per session","Verify totals match sum of individual sessions"],"passes":true},{"id":"F004","category":"core","description":"Write token usage to progress.txt for each session","priority":"critical","steps":["Update progress.txt writer to include token metrics","Add 'Input tokens', 'Output tokens', and 'Total tokens' fields","Format token counts with thousands separators","Verify token data persists across sessions"],"passes":true},{"id":"F005","category":"core","description":"Track token usage during pace init command","priority":"high","steps":["Capture token usage from initialization session","Display tokens used in initialization summary","Write token metrics to initial progress.txt entry","Verify init token tracking works independently"],"passes":true},{"id":"F006","category":"functional","description":"Include token usage in JSON output format","priority":"high","steps":["Add tokenUsage field to SessionSummary type output","Include per-session token breakdown in JSON","Add total token usage to JSON orchestration summary","Verify JSON output is valid and parseable"],"passes":true},{"id":"F007","category":"functional","description":"Display token usage in pace status command","priority":"high","steps":["Extract token data from progress.txt using existing parser","Display last session token usage in status output","Show total token usage across all sessions","Verify status command shows accurate token counts"],"passes":true},{"id":"F008","category":"functional","description":"Include token usage in verbose session details","priority":"medium","steps":["Add token count to verbose session details output","Show tokens per feature in verbose mode","Format verbose token display consistently","Verify verbose output includes token information"],"passes":true},{"id":"F009","category":"ui","description":"Format token counts with thousands separators for readability","priority":"medium","steps":["Use toLocaleString() for all token displays","Apply consistent formatting across all outputs","Verify comma separators appear for large numbers","Test with token counts > 1000"],"passes":true},{"id":"F010","category":"ui","description":"Add emoji indicator for token usage display","priority":"low","steps":["Add ðŸ’Ž emoji prefix to token usage sections","Use consistent emoji across all token displays","Verify emoji appears in status and summary outputs","Check emoji displays correctly in terminal"],"passes":true},{"id":"F011","category":"error-handling","description":"Handle missing token usage data gracefully","priority":"high","steps":["Check for undefined tokenUsage before displaying","Skip token display when data unavailable","Don't break output if tokens missing","Test with sessions that have no token data"],"passes":true},{"id":"F012","category":"error-handling","description":"Handle zero token usage edge case","priority":"medium","steps":["Display zero tokens if session returns 0","Don't confuse zero tokens with missing data","Show 0 tokens in displays appropriately","Test edge case of 0 input or 0 output tokens"],"passes":true},{"id":"F013","category":"integration","description":"Extract token usage from OpenCode SDK session events","priority":"critical","steps":["Monitor OpenCode event stream for usage data","Parse token usage from message.part.updated events","Extract usage from session metadata if available","Verify token extraction works with current SDK version"],"passes":true},{"id":"F014","category":"integration","description":"Add fallback for SDK versions without token usage","priority":"high","steps":["Detect when SDK doesn't provide token data","Display helpful message about manual tracking","Document how to track tokens via provider dashboard","Test with different SDK versions"],"passes":true},{"id":"F015","category":"functional","description":"Calculate cost estimates based on token usage (optional)","priority":"low","steps":["Add model pricing data for common providers","Calculate cost from token counts and model ID","Display estimated cost in session summaries","Allow users to configure custom pricing"],"passes":true},{"id":"F016","category":"functional","description":"Export token usage data to CSV or JSON file","priority":"low","steps":["Add --export-tokens flag to orchestrator","Generate CSV with session, feature, and token data","Include timestamps and model information","Verify exported data is accurate and complete"],"passes":true},{"id":"F017","category":"testing","description":"Add unit tests for token usage tracking","priority":"high","steps":["Test SessionMetrics token usage storage","Test token aggregation across sessions","Test JSON output includes token data","Verify all tests pass with bun test"],"passes":true},{"id":"F018","category":"testing","description":"Add integration tests for token display","priority":"medium","steps":["Test token display in session summary","Test token display in orchestration summary","Test token extraction from progress.txt","Verify status command shows token data"],"passes":true},{"id":"F019","category":"testing","description":"Test token usage with dry-run mode","priority":"medium","steps":["Verify dry-run doesn't track tokens","Ensure token displays are skipped in dry-run","Test dry-run JSON output excludes tokens","Confirm no token data written in dry-run"],"passes":true},{"id":"F020","category":"documentation","description":"Update README with token usage features","priority":"high","steps":["Add token tracking to Features section","Document token display in output examples","Explain how to view token usage in status","Add note about SDK version requirements"],"passes":true},{"id":"F021","category":"documentation","description":"Add JSDoc comments for token-related types","priority":"medium","steps":["Document TokenUsage interface in types.ts","Add comments to SessionMetrics.tokenUsage","Document SessionSummary.tokenUsage field","Explain token tracking in function docs"],"passes":true},{"id":"F022","category":"documentation","description":"Create troubleshooting guide for missing token data","priority":"low","steps":["Document why tokens might not appear","Explain SDK version requirements","Provide workarounds for manual tracking","Add FAQ entry about token usage"],"passes":true},{"id":"F023","category":"ui","description":"Show token usage in progress indicator tooltip","priority":"low","steps":["Add real-time token count to progress display","Update progress indicator with running total","Show tokens alongside tool call count","Verify progress display updates smoothly"],"passes":true},{"id":"F024","category":"functional","description":"Track separate token usage for different model tiers","priority":"low","steps":["Detect model ID from session configuration","Track tokens separately by model (sonnet, opus, etc)","Display per-model token breakdown","Sum tokens correctly across different models"],"passes":true},{"id":"F025","category":"performance","description":"Optimize token data storage in large progress files","priority":"low","steps":["Ensure token writing doesn't slow down sessions","Test with progress.txt > 100 sessions","Verify parsing performance is acceptable","Profile token extraction on large files"],"passes":true},{"id":"F026","category":"functional","description":"Add token budget warnings when approaching limits","priority":"low","steps":["Allow configuring token budget per session","Warn when session exceeds budget threshold","Track cumulative tokens vs total budget","Display budget remaining in status"],"passes":true},{"id":"F027","category":"functional","description":"Show token efficiency metrics (tokens per feature)","priority":"low","steps":["Calculate average tokens per completed feature","Display tokens/feature ratio in summary","Track most/least token-intensive features","Identify optimization opportunities"],"passes":true},{"id":"F028","category":"integration","description":"Support token tracking with external OpenCode servers","priority":"medium","steps":["Verify token tracking works with --url flag","Extract tokens from external server events","Test with both embedded and external servers","Ensure consistent behavior across connection types"],"passes":true},{"id":"F029","category":"testing","description":"Add test coverage for token calculation edge cases","priority":"medium","steps":["Test with very large token counts (> 1M)","Test with zero token sessions","Test with missing input or output tokens","Verify sum calculations handle all edge cases"],"passes":true},{"id":"F030","category":"accessibility","description":"Ensure token displays work in non-color terminals","priority":"low","steps":["Test token output in plain text terminals","Verify numbers are readable without emoji","Ensure formatting works with screen readers","Test with NO_COLOR environment variable"],"passes":true},{"id":"F031","category":"functional","description":"Add token usage to archive metadata","priority":"low","steps":["Include total tokens in archive metadata.json","Store per-session token breakdown in archives","Display token usage when listing archives","Verify archived token data is accurate"],"passes":true},{"id":"F032","category":"functional","description":"Track token usage in pace-coordinate continuous sessions","priority":"medium","steps":["Accumulate tokens across coordinate sessions","Display running token total in coordinator","Write cumulative tokens to progress file","Test token tracking in multi-session runs"],"passes":true},{"id":"F033","category":"ui","description":"Add visual indicator when token usage exceeds thresholds","priority":"low","steps":["Highlight token counts that exceed average","Use color coding for high token sessions","Add warning symbol for expensive sessions","Make thresholds configurable"],"passes":true},{"id":"F034","category":"error-handling","description":"Validate token usage data integrity","priority":"medium","steps":["Check that total = input + output","Warn if token values seem unrealistic","Handle negative token counts gracefully","Log validation errors for debugging"],"passes":true},{"id":"F035","category":"testing","description":"Test token tracking with verbose and non-verbose modes","priority":"medium","steps":["Verify tokens appear in verbose output","Verify tokens appear in non-verbose summary","Test token display in JSON mode","Ensure consistent data across all modes"],"passes":true},{"id":"F036","category":"functional","description":"Add command to query historical token usage","priority":"low","steps":["Create 'pace tokens' command","Show token statistics from progress.txt","Display token trends over time","Support filtering by date range or feature"],"passes":true},{"id":"F037","category":"integration","description":"Update pace.json schema to include token configuration","priority":"low","steps":["Add tokenTracking section to config","Support enabling/disabling token display","Allow configuring token budget limits","Document config options in README"],"passes":true},{"id":"F038","category":"functional","description":"Show token usage comparison between sessions","priority":"low","steps":["Track previous session token count","Display delta from last session","Show percentage increase/decrease","Highlight significant changes"],"passes":true},{"id":"F039","category":"performance","description":"Cache parsed token data from progress.txt","priority":"low","steps":["Avoid re-parsing progress file on every status call","Cache token totals with file modification check","Invalidate cache when progress.txt changes","Benchmark performance improvement"],"passes":true},{"id":"F040","category":"testing","description":"Add end-to-end test for complete token tracking workflow","priority":"high","steps":["Run full orchestration with token tracking","Verify tokens in all outputs (console, JSON, progress.txt)","Check token totals are accurate","Ensure status command reads tokens correctly"],"passes":true},{"id":"F041","category":"ui","description":"Display token usage with appropriate precision","priority":"low","steps":["Use whole numbers for token counts","Don't display decimal places for tokens","Show K/M suffixes for very large counts (optional)","Ensure consistency across all displays"],"passes":true},{"id":"F042","category":"functional","description":"Support manual token entry for sessions without SDK data","priority":"low","steps":["Add --tokens flag to update command","Allow manual input/output token specification","Write manual tokens to progress.txt","Include manual tokens in totals"],"passes":true},{"id":"F043","category":"documentation","description":"Add examples of token usage output to documentation","priority":"medium","steps":["Add screenshot or example of token display","Show sample progress.txt with token data","Demonstrate status command token output","Include JSON output example with tokens"],"passes":true},{"id":"F044","category":"testing","description":"Test token tracking with multiple providers (Anthropic, OpenAI, etc)","priority":"low","steps":["Verify tokens tracked for Claude models","Verify tokens tracked for GPT models","Test with different provider formats","Ensure provider-agnostic implementation"],"passes":true},{"id":"F045","category":"error-handling","description":"Handle token overflow for extremely long sessions","priority":"low","steps":["Test with sessions generating millions of tokens","Ensure no integer overflow in calculations","Display large numbers correctly","Use BigInt if necessary for huge totals"],"passes":true},{"id":"F046","category":"functional","description":"Include token usage in pace-review code review reports","priority":"low","steps":["Track tokens used by review agent","Display review session token cost","Compare review vs implementation tokens","Add to review session summary"],"passes":true},{"id":"F047","category":"integration","description":"Update TypeScript types to make token usage properly typed","priority":"high","steps":["Ensure TokenUsage interface is exported","Add proper type annotations to all token fields","Remove any 'any' types in token handling","Verify type safety with TypeScript compiler"],"passes":true},{"id":"F048","category":"functional","description":"Show token usage breakdown in pace validate command","priority":"low","steps":["Add token summary to validation output","Show tokens used across project lifetime","Display average tokens per feature category","Include in JSON validation output"],"passes":true},{"id":"F049","category":"testing","description":"Add regression tests for token usage display formats","priority":"medium","steps":["Test comma formatting in token displays","Test token display in different locales","Verify consistent formatting across outputs","Snapshot test token display strings"],"passes":true},{"id":"F050","category":"functional","description":"Add total project token count to feature_list.json metadata","priority":"low","steps":["Add token_usage field to metadata","Update metadata when sessions complete","Include total input/output/total tokens","Display in status command"],"passes":true},{"id":"F051","category":"ui","description":"Create condensed token summary for quick status checks","priority":"low","steps":["Add one-line token summary to compact status","Show total tokens with K/M suffix","Include in printCompactStatus output","Make it visually distinct"],"passes":true},{"id":"F052","category":"performance","description":"Ensure token tracking doesn't impact session performance","priority":"medium","steps":["Benchmark session execution with token tracking","Verify no significant overhead added","Test with high-frequency token updates","Profile token calculation performance"],"passes":true},{"id":"F053","category":"error-handling","description":"Handle corrupted token data in progress.txt gracefully","priority":"medium","steps":["Detect malformed token entries","Skip corrupted entries without crashing","Log warnings about data issues","Continue with partial token data"],"passes":true},{"id":"F054","category":"functional","description":"Support filtering session metrics by token usage","priority":"low","steps":["Add ability to filter high-token sessions","Show sessions above token threshold","Identify token-intensive features","Help optimize expensive operations"],"passes":true},{"id":"F055","category":"documentation","description":"Document OpenCode SDK event format for token extraction","priority":"medium","steps":["Document expected event structure","Explain which events contain token data","Add code comments for SDK integration","Note SDK version compatibility"],"passes":true},{"id":"F056","category":"testing","description":"Test token persistence across orchestrator restarts","priority":"medium","steps":["Write tokens to progress.txt","Stop and restart orchestrator","Verify token totals are preserved","Ensure cumulative tracking works"],"passes":true},{"id":"F057","category":"integration","description":"Handle model provider rate limit errors related to tokens","priority":"low","steps":["Detect rate limit errors in responses","Display token usage at rate limit","Suggest waiting period based on usage","Log token counts for debugging"],"passes":true},{"id":"F058","category":"ui","description":"Add color coding to token displays based on magnitude","priority":"low","steps":["Use green for low token counts","Use yellow for medium token usage","Use red for high token sessions","Make color thresholds configurable"],"passes":true},{"id":"F059","category":"functional","description":"Calculate token efficiency score (features/tokens ratio)","priority":"low","steps":["Divide completed features by total tokens","Display efficiency score in summary","Track efficiency trends over time","Identify most efficient sessions"],"passes":true},{"id":"F060","category":"testing","description":"Add mock tests for SDK event parsing without real API calls","priority":"high","steps":["Create mock OpenCode event stream","Inject test token usage data","Verify extraction logic works correctly","Test without making real API requests"],"passes":true}],"metadata":{"project_name":"Pace Token Usage Tracking","created_at":"2025-12-17","total_features":60,"passing":60,"failing":0,"last_updated":"2025-12-19T16:52:35.681Z","token_usage":{"input":11893308,"output":439971,"total":12333279}}}
